
R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(vegan)
Loading required package: permute
Loading required package: lattice
This is vegan 2.4-3
> 
> #########
> # setup handling to remove the DNA rows
> remove_rows <- c("DConD0R1", "DConD0R2")
> 
> # read the sample metadata
> md <- read.table("sample_info.xls", header=T, sep='\t', row.names=1, comment.char="")
> md <- md[!rownames(md) %in% remove_rows, ]
> dim(md)
[1] 22 10
> head(md)
          BarcodeSequence LinkerPrimerSequence    BarcodeName ProjectName
ConD0R12         CAGTTCAT    CCTACGGGNGGCWGCAG illwhoi341bar1   052517MA1
ConD0R21         CAGTTGCA    CCTACGGGNGGCWGCAG illwhoi341bar2   052517MA1
ConD56R21        CATGCGCA    CCTACGGGNGGCWGCAG illwhoi341bar8   052517MA1
ConD7R21         CATAACAA    CCTACGGGNGGCWGCAG illwhoi341bar3   052517MA1
CX1D56R21        CATGGAAG    CCTACGGGNGGCWGCAG illwhoi341bar9   052517MA1
CX1D7R21         CATAATAG    CCTACGGGNGGCWGCAG illwhoi341bar4   052517MA1
          Description     condition replicate    pesticide day concentration
ConD0R12     ConD0R12  control_day0         1      control   0             0
ConD0R21     ConD0R21  control_day0         2      control   0             0
ConD56R21   ConD56R21 control_day56         2      control  56             0
ConD7R21     ConD7R21  control_day7         2      control   7             0
CX1D56R21   CX1D56R21  chl_X1_day56         2 chlorpyrifos  56            x1
CX1D7R21     CX1D7R21   chl_X1_day7         2 chlorpyrifos   7            x1
> 
> # read the normalized read_sums
> sample_read_sums <- read.table("10.normalize.read_sums.xls", header=T, sep="\t", row.names=1)
> sample_read_sums
      ConD0R12 ConD0R21 ConD56R21 ConD7R21 CX1D56R21 CX1D7R21 CX4D56R21
Zotu1    64673    55226     76922    57390     68222    58450     58795
      CX4D7R21 YX1D56R21 YX1D7R21 YX4D56R21 YX4D7R21 ConD56R12 ConD7R11
Zotu1    51711     66802    71003     60232    62049     58154    53478
      CX1D56R11 CX1D7R11 CX4D56R11 CX4D7R11 DConD0R1 DConD0R2 YX1D56R11
Zotu1     40237    51565     48115    47670    26885    22158     49049
      YX1D7R11 YX4D56R11 YX4D7R11
Zotu1    50098     44115    43745
> dim(sample_read_sums)
[1]  1 24
> sample_read_sums <- sample_read_sums[, !names(sample_read_sums) %in% remove_rows]
> 
> # read the persistent taxa list
> best.tax <- read.table("11.best_tax.xls", header=T, sep='\t', row.names=1)
> best.tax <- best.tax[, !names(best.tax) %in% remove_rows]
> best.tax$desc <- sprintf("%s : %s (%s, %.2g)", rownames(best.tax), best.tax$best_tax, best.tax$best_tax_level, best.tax$best_tax_confidence)
> 
> # read in the raw data
> raw_otus <- read.table("pesticide_community.xls", header=T, sep='\t', row.names=1)
> raw_otus <- raw_otus[, !names(raw_otus) %in% remove_rows]
> raw_otus <- raw_otus[, -which(names(raw_otus) %in% c("domain", "domain_confidence", "phylum", "phylum_confidence", "class", "class_confidence", "order_", "order_confidence", "family", "family_confidence", "genus", "genus_confidence", "species", "species_confidence", "sequence"))]
> head(raw_otus)
       ConD0R12 ConD0R21 ConD56R21 ConD7R21 CX1D56R21 CX1D7R21 CX4D56R21
Zotu8       338      503      3179     3170      2037     3302      2874
Zotu5      1307      828      3035     3224      4438     3821      1386
Zotu3       159      252      1872     2280       707     2316       601
Zotu1      1648     1173      1231     2195       871     1755       805
Zotu7       431      448      1606      591       543     1061       788
Zotu48      710      570      1174      373      2075      284      1132
       CX4D7R21 YX1D56R21 YX1D7R21 YX4D56R21 YX4D7R21 ConD56R12 ConD7R11
Zotu8      5302       837     4524       479     4163      2537     4912
Zotu5      3117      1147     3775       694     1735      4148     3805
Zotu3      2273       369     3119       248     3187      1612     3667
Zotu1      1272       358     2652      1143     1137      2694     1678
Zotu7      1264       940     1402       458      888      2162     2220
Zotu48      202      2076     1407      1547     1332      1047      414
       CX1D56R11 CX1D7R11 CX4D56R11 CX4D7R11 YX1D56R11 YX1D7R11 YX4D56R11
Zotu8       1960     4254      2030     5025       933     3048      1100
Zotu5       3443     2704       987     3214      1064     3670       401
Zotu3        596     3050       625     3610       381     2564       455
Zotu1        230     1275       275      841       375     1191       481
Zotu7        756     1975      1879     1620       879     1522       601
Zotu48      1232      897       976      586      1285      639       913
       YX4D7R11
Zotu8      2648
Zotu5      2255
Zotu3      2065
Zotu1      2159
Zotu7       985
Zotu48      330
> dim(raw_otus)
[1] 5350   22
> 
> # create the fractional abundance data
> otus_pcnt <- scale(raw_otus, center=FALSE, scale=t(sample_read_sums))
> head(otus_pcnt)
          ConD0R12    ConD0R21  ConD56R21   ConD7R21   CX1D56R21    CX1D7R21
Zotu8  0.005226292 0.009108029 0.04132758 0.05523610 0.029858403 0.056492729
Zotu5  0.020209361 0.014992938 0.03945555 0.05617703 0.065052329 0.065372113
Zotu3  0.002458522 0.004563068 0.02433634 0.03972818 0.010363226 0.039623610
Zotu1  0.025482040 0.021239996 0.01600322 0.03824708 0.012767143 0.030025663
Zotu7  0.006664296 0.008112121 0.02087829 0.01029796 0.007959309 0.018152267
Zotu48 0.010978306 0.010321226 0.01526221 0.00649939 0.030415409 0.004858854
        CX4D56R21    CX4D7R21   YX1D56R21   YX1D7R21   YX4D56R21   YX4D7R21
Zotu8  0.04888171 0.102531376 0.012529565 0.06371562 0.007952583 0.06709214
Zotu5  0.02357343 0.060277310 0.017170145 0.05316677 0.011522114 0.02796177
Zotu3  0.01022196 0.043955831 0.005523787 0.04392772 0.004117413 0.05136263
Zotu1  0.01369164 0.024598248 0.005359121 0.03735053 0.018976624 0.01832423
Zotu7  0.01340250 0.024443542 0.014071435 0.01974564 0.007603931 0.01431127
Zotu48 0.01925334 0.003906326 0.031076914 0.01981606 0.025684022 0.02146691
        ConD56R12    ConD7R11   CX1D56R11   CX1D7R11   CX4D56R11   CX4D7R11
Zotu8  0.04362555 0.091850855 0.048711385 0.08249782 0.042190585 0.10541221
Zotu5  0.07132785 0.071150754 0.085568010 0.05243867 0.020513353 0.06742186
Zotu3  0.02771950 0.068570253 0.014812237 0.05914865 0.012989712 0.07572897
Zotu1  0.04632527 0.031377389 0.005716132 0.02472607 0.005715473 0.01764212
Zotu7  0.03717715 0.041512398 0.018788677 0.03830117 0.039052271 0.03398364
Zotu48 0.01800392 0.007741501 0.030618585 0.01739552 0.020284734 0.01229285
         YX1D56R11   YX1D7R11   YX4D56R11    YX4D7R11
Zotu8  0.019021795 0.06084075 0.024934829 0.060532632
Zotu5  0.021692593 0.07325642 0.009089879 0.051548748
Zotu3  0.007767742 0.05117969 0.010313952 0.047205395
Zotu1  0.007645416 0.02377340 0.010903321 0.049354212
Zotu7  0.017920855 0.03038045 0.013623484 0.022516859
Zotu48 0.026198292 0.01275500 0.020695908 0.007543719
> otus_pcnt <- otus_pcnt[apply(otus_pcnt[,-1], 1, function(x) !all(x==0)),]
> dim(otus_pcnt)
[1] 5166   22
> 
> # read the log normalized data
> log_otus <- read.table("pesticide_community.log_normalized.xls", header=T, sep='\t', row.names=1)
> log_otus <- log_otus[, !names(log_otus) %in% remove_rows]
> log_otus <- log_otus[, !names(log_otus) %in% c("domain", "domain_confidence", "phylum", "phylum_confidence", "class", "class_confidence", "order_", "order_confidence", "family", "family_confidence", "genus", "genus_confidence", "species", "species_confidence", "sequence")]
> head(log_otus)
       ConD0R12 ConD0R21 ConD56R21 ConD7R21 CX1D56R21 CX1D7R21 CX4D56R21
Zotu8    8.8881   9.3114   10.9530 11.14428   10.6266 11.18468   10.9772
Zotu5    9.9913   9.7115   10.8855 11.14291   11.4117 11.31969   10.2290
Zotu3    7.9118   8.3680   10.1546 10.55821    9.3094 10.57266    9.1586
Zotu1    9.8977   9.7049    9.6693 10.46613    9.4468 10.22638    9.3713
Zotu7    8.6053   8.7750    9.9362  9.12948    8.9880  9.70239    9.3457
Zotu48   9.0262   8.9613    9.5861  8.66623   10.3057  8.42381    9.6754
       CX4D7R21 YX1D56R21 YX1D7R21 YX4D56R21 YX4D7R21 ConD56R12 ConD7R11
Zotu8   12.0239    9.7114  11.4938    9.2008 11.51111      11.0  12.0744
Zotu5   11.4308    9.9728  11.2833    9.4791 10.58535      12.0  11.7778
Zotu3   10.8835    8.6502  10.8685    8.2852 11.00010      10.0  11.5463
Zotu1   10.2117    8.5460  10.6435    9.5905  9.85561      11.0  10.6377
Zotu7   10.2011    9.4392   9.9647    8.7155  9.60089      11.0  10.9395
Zotu48   8.3977   10.2220   9.9394    9.8638  9.98585       9.9   9.1652
       CX1D56R11 CX1D7R11 CX4D56R11 CX4D7R11 YX1D56R11 YX1D7R11 YX4D56R11
Zotu8    11.2996  11.8394   10.9936  12.2584   10.2271 11.41360   10.6220
Zotu5    11.8880  11.3345   10.2525  11.7501   10.3310 11.59452    9.6467
Zotu3     9.8212  11.2624    9.5428  11.6899    9.0797 11.00297    9.4737
Zotu1     8.8436  10.2687    8.7069  10.0567    8.9951 10.13151    9.4645
Zotu7    10.0016  10.7343   10.6180  10.7514    9.8245 10.38654    9.6821
Zotu48   10.4909   9.8686    9.8965   9.6516   10.1909  9.46062   10.0834
       YX4D7R11
Zotu8  11.30114
Zotu5  11.11380
Zotu3  10.80521
Zotu1  10.80448
Zotu7   9.96565
Zotu48  8.85685
> 
> # extract out the persistent OTUs
> log_otus <- log_otus[row.names(best.tax),]
> otus_pcnt <- otus_pcnt[row.names(best.tax),]
> dim(log_otus)
[1] 39 22
> 
> # make the full sample dataframe
> sample_full <- data.frame(t(log_otus), pesticide = md$pesticide, day = md$day, concentration = md$concentration)
> dim(sample_full)
[1] 22 42
> sample_full
             Zotu8    Zotu5    Zotu3    Zotu1    Zotu7   Zotu48   Zotu11
ConD0R12   8.88810  9.99130  7.91180  9.89770  8.60530  9.02620  7.37140
ConD0R21   9.31140  9.71150  8.36800  9.70490  8.77500  8.96130  9.69170
ConD56R21 10.95300 10.88550 10.15460  9.66930  9.93620  9.58610  8.57000
ConD7R21  11.14428 11.14291 10.55821 10.46613  9.12948  8.66623  8.26258
CX1D56R21 10.62660 11.41170  9.30940  9.44680  8.98800 10.30570  9.78490
CX1D7R21  11.18468 11.31969 10.57266 10.22638  9.70239  8.42381  8.42166
CX4D56R21 10.97720 10.22900  9.15860  9.37130  9.34570  9.67540  8.22960
CX4D7R21  12.02390 11.43080 10.88350 10.21170 10.20110  8.39770  8.56770
YX1D56R21  9.71140  9.97280  8.65020  8.54600  9.43920 10.22200  9.44580
YX1D7R21  11.49380 11.28330 10.86850 10.64350  9.96470  9.93940  8.23680
YX4D56R21  9.20080  9.47910  8.28520  9.59050  8.71550  9.86380  9.03780
YX4D7R21  11.51111 10.58535 11.00010  9.85561  9.60089  9.98585  8.13129
ConD56R12 11.00000 12.00000 10.00000 11.00000 11.00000  9.90000  9.30000
ConD7R11  12.07440 11.77780 11.54630 10.63770 10.93950  9.16520  8.91170
CX1D56R11 11.29960 11.88800  9.82120  8.84360 10.00160 10.49090 10.60320
CX1D7R11  11.83940 11.33450 11.26240 10.26870 10.73430  9.86860  8.57410
CX4D56R11 10.99360 10.25250  9.54280  8.70690 10.61800  9.89650  8.36430
CX4D7R11  12.25840 11.75010 11.68990 10.05670 10.75140  9.65160  8.89410
YX1D56R11 10.22710 10.33100  9.07970  8.99510  9.82450 10.19090 10.70460
YX1D7R11  11.41360 11.59452 11.00297 10.13151 10.38654  9.46062  9.02883
YX4D56R11 10.62200  9.64670  9.47370  9.46450  9.68210 10.08340 12.06390
YX4D7R11  11.30114 11.11380 10.80521 10.80448  9.96565  8.85685  8.95427
           Zotu89  Zotu55  Zotu71  Zotu110 Zotu311  Zotu59  Zotu87   Zotu46
ConD0R12  9.11340 8.86850 9.13450  7.59200 8.51820 8.88290 8.64520  6.02150
ConD0R21  8.95170 9.09700 8.95490  8.30880 8.49550 8.59650 8.40900  7.68160
ConD56R21 9.43450 9.08050 9.27670  8.75350 9.10460 8.68610 8.52530  8.48750
ConD7R21  8.81532 9.05956 8.58453  8.33531 8.34701 7.42251 8.48749  7.25533
CX1D56R21 9.32290 9.45900 8.77600  9.13170 9.09830 8.79520 8.74770  8.15450
CX1D7R21  8.19719 8.87667 8.51797  8.36084 8.40562 7.56918 8.12831  7.58165
CX4D56R21 8.69350 9.47730 8.70500  8.96550 8.83060 8.23290 8.82590  7.32720
CX4D7R21  8.20010 8.86480 8.82020  8.63660 8.41210 7.06660 8.16980  7.69120
YX1D56R21 8.96650 9.75020 8.56800  8.98960 8.94830 9.30440 9.47240  9.08570
YX1D7R21  9.70260 9.06980 9.11990  8.91900 9.06300 8.37170 8.26010  8.08390
YX4D56R21 9.16780 9.13800 8.41480  8.31630 8.44350 8.44080 8.94890  7.27310
YX4D7R21  9.90407 8.89078 9.50015  8.96538 9.35662 9.12736 8.46317  7.57262
ConD56R12 9.60000 9.10000 9.40000  9.60000 9.00000 8.00000 8.10000  8.90000
ConD7R11  9.62340 8.88850 9.45850  8.78890 8.94220 8.32610 8.04580  8.29700
CX1D56R11 9.81200 9.39700 9.75090 10.23820 9.47200 8.49840 8.56920  9.49350
CX1D7R11  9.33840 8.87470 9.57790  8.97310 9.02550 8.59610 8.02270  8.25080
CX4D56R11 9.73450 8.99370 9.61870 10.23500 9.23460 9.38530 8.69150  9.10170
CX4D7R11  9.62970 8.88670 9.09050  9.25390 9.04140 8.29720 8.23940  8.76730
YX1D56R11 9.32560 9.37380 8.45440  9.62650 9.12670 9.46260 9.48050 10.24630
YX1D7R11  9.08582 9.02820 8.56364  9.00962 8.79574 7.91965 8.61993  8.38819
YX4D56R11 9.89560 9.16790 9.31870  9.55990 9.19430 9.78190 8.57360 10.05410
YX4D7R11  8.73851 8.82426 8.96033  8.74823 8.67421 7.68081 8.13105  7.59962
          Zotu146   Zotu60 Zotu142 Zotu346  Zotu66  Zotu93 Zotu423 Zotu222
ConD0R12  8.50710  5.89830 8.26760 8.78290 8.55610 8.27360 8.76200 7.92990
ConD0R21  8.61420  6.18130 8.44580 8.32950 8.10510 8.52440 8.17440 7.92510
ConD56R21 8.69330  7.75910 8.79100 8.69220 8.52780 8.28910 8.64640 9.15860
ConD7R21  8.48343  7.46678 7.25792 8.48320 8.26916 8.32253 8.38024 8.13045
CX1D56R21 8.48720  7.87260 9.26440 7.76640 9.22770 8.36240 7.74580 7.85330
CX1D7R21  8.63378  9.18106 6.66948 8.50219 7.94046 7.94249 8.37352 7.91089
CX4D56R21 8.62290  7.62800 8.47860 7.89100 7.55940 8.58310 7.64370 7.56450
CX4D7R21  8.54580 10.17450 6.55450 8.64080 7.66320 8.11770 8.47140 7.67500
YX1D56R21 9.01170  6.36200 8.43820 7.73600 8.50720 8.76110 7.35720 7.90170
YX1D7R21  8.50930  8.04530 8.38510 8.79920 8.39710 8.17510 8.79520 8.54190
YX4D56R21 8.55510  6.02440 8.53740 8.28400 8.01190 8.63310 8.13000 8.05740
YX4D7R21  8.91674  7.71175 8.74905 8.56668 7.80713 8.11374 8.39800 8.74311
ConD56R12 8.30000  8.40000 7.80000 8.40000 9.30000 8.00000 8.50000 8.60000
ConD7R11  8.31370  9.23510 7.80560 9.12520 8.34320 7.64460 9.12840 8.16200
CX1D56R11 8.50510  8.17780 8.29700 8.12960 8.53610 8.38920 8.01380 8.57590
CX1D7R11  8.67330  9.61690 7.98740 8.57460 8.29900 7.97400 8.59180 8.39130
CX4D56R11 8.32200  7.49580 8.74600 8.18660 6.68710 8.36870 7.98620 7.69310
CX4D7R11  8.54160  9.73220 8.08380 8.68270 8.54730 8.01290 8.66860 8.49100
YX1D56R11 8.82190  6.91560 8.66050 7.62600 7.90290 8.93570 7.36780 8.49720
YX1D7R11  8.84385  8.24460 7.80588 8.25429 8.58428 8.28224 8.29385 8.74564
YX4D56R11 8.41410  7.74950 9.33920 8.04260 7.67900 8.10060 7.90870 8.06880
YX4D7R11  8.44497  8.65705 7.34751 8.21216 8.35980 7.92267 8.15990 8.17044
          Zotu230  Zotu53 Zotu225 Zotu387 Zotu109  Zotu80  Zotu94  Zotu83
ConD0R12  8.56390 8.01760 8.72040 7.51420 6.13190 5.14690 7.30150 5.30380
ConD0R21  8.27680 7.92910 8.38540 7.29250 8.04430 6.14680 7.61760 6.02350
ConD56R21 8.58490 8.39100 8.22950 8.16760 7.37660 9.91730 6.95520 8.03320
ConD7R21  8.39683 7.08051 7.37880 7.26178 7.11772 6.14897 8.40987 6.73310
CX1D56R21 7.82630 8.69470 8.30230 8.52250 7.41840 7.45680 7.67490 6.84620
CX1D7R21  8.41026 6.90788 7.41501 7.00454 6.36334 6.83736 8.10019 7.29070
CX4D56R21 7.77420 7.92450 8.12400 8.06270 6.91640 7.68120 7.43560 7.04630
CX4D7R21  8.62420 6.67160 7.36380 6.65540 6.76670 7.63070 8.37260 7.73930
YX1D56R21 7.51820 7.97430 8.81840 8.64670 8.07020 6.61070 7.65810 6.90770
YX1D7R21  8.69940 8.45270 7.79600 8.12410 9.33430 6.93820 8.21980 7.64580
YX4D56R21 8.13300 7.92370 7.95760 8.43860 8.22310 6.00670 7.82010 5.79660
YX4D7R21  8.31470 8.73516 8.41698 8.18591 8.69580 6.94169 7.75250 6.81252
ConD56R12 8.30000 8.30000 7.40000 8.30000 7.50000 9.60000 7.10000 8.50000
ConD7R11  8.79190 8.00770 7.93840 7.67070 8.47940 7.05990 8.19000 7.88540
CX1D56R11 7.98180 8.69450 7.78070 8.71330 7.33680 7.73100 7.90750 8.16940
CX1D7R11  8.35760 8.31360 7.86890 8.18530 7.73780 7.32840 7.81100 7.77480
CX4D56R11 7.98100 8.67850 8.54730 8.19990 7.27380 7.34040 7.66510 8.98290
CX4D7R11  8.45360 8.28700 7.61270 8.02900 8.84670 7.39690 8.72850 8.72990
YX1D56R11 7.68620 8.51240 8.70700 8.73860 7.79870 6.96560 7.58070 8.08000
YX1D7R11  8.07253 7.98095 7.48292 7.90275 8.91022 6.62238 8.73881 7.84910
YX4D56R11 7.92420 9.03520 8.68900 8.69480 8.43630 7.27420 7.81810 7.68450
YX4D7R11  8.02750 7.47655 7.27305 7.39662 7.75016 6.29505 8.47891 6.58514
          Zotu183 Zotu407 Zotu169 Zotu445 Zotu449 Zotu427 Zotu378 Zotu481
ConD0R12  5.40870 7.20440 6.27530 6.33460 7.04820 6.67540 3.12120 5.03850
ConD0R21  5.28120 7.04850 6.12340 6.44230 6.92260 6.29840 3.70660 5.05860
ConD56R21 7.18490 6.82120 7.09040 6.86460 6.88090 8.32130 4.19490 5.47640
ConD7R21  7.71083 6.37449 7.20267 6.14379 6.57203 6.18621 4.08399 5.85866
CX1D56R21 6.58460 7.31510 7.04450 6.79640 6.86130 6.00600 3.73690 5.44920
CX1D7R21  7.80925 6.44843 8.29799 5.69812 6.32775 6.26032 4.43753 7.14151
CX4D56R21 6.88600 7.06690 6.38920 6.23080 6.85660 5.88970 4.12950 5.36810
CX4D7R21  8.72040 6.57310 7.21210 5.78230 6.37950 6.28080 4.59300 8.78830
YX1D56R21 5.65390 7.60040 5.95410 6.27250 7.32290 6.71760 4.45030 4.95390
YX1D7R21  7.69820 6.27110 6.88540 8.11230 6.45470 6.69660 3.62550 5.38890
YX4D56R21 5.57790 7.29250 6.24180 6.48410 6.91570 6.43490 4.53070 4.97610
YX4D7R21  7.90071 7.15288 6.76149 7.10646 6.88114 6.82560 4.38531 5.41352
ConD56R12 7.50000 6.30000 8.00000 7.40000 6.60000 6.10000 5.00000 4.50000
ConD7R11  8.44110 6.80920 8.18430 7.08700 6.92850 6.31130 4.50770 5.59600
CX1D56R11 6.75180 6.63010 7.90590 7.58650 6.78340 6.05020 4.63070 4.94440
CX1D7R11  8.32810 6.41180 8.79880 6.90090 6.72190 6.68890 4.39090 5.69390
CX4D56R11 6.64060 6.94810 7.30120 7.32560 6.82300 6.28910 4.49520 4.27830
CX4D7R11  8.69870 6.67050 8.63370 9.09360 6.59640 6.51160 4.74080 5.22420
YX1D56R11 6.05330 7.61690 6.96810 6.82160 7.93370 6.48470 5.20210 4.07330
YX1D7R11  7.76398 6.88837 6.84666 6.79179 7.03768 6.69510 5.66074 4.73862
YX4D56R11 6.06470 7.41510 7.13110 7.50600 7.27380 6.01890 4.90240 4.08040
YX4D7R11  7.76183 6.79190 6.61687 6.71381 6.74973 6.30372 5.99048 5.47595
             pesticide day concentration
ConD0R12       control   0             0
ConD0R21       control   0             0
ConD56R21      control  56             0
ConD7R21       control   7             0
CX1D56R21 chlorpyrifos  56            x1
CX1D7R21  chlorpyrifos   7            x1
CX4D56R21 chlorpyrifos  56            x4
CX4D7R21  chlorpyrifos   7            x4
YX1D56R21 cypermethrin  56            x1
YX1D7R21  cypermethrin   7            x1
YX4D56R21 cypermethrin  56            x4
YX4D7R21  cypermethrin   7            x4
ConD56R12      control  56             0
ConD7R11       control   7             0
CX1D56R11 chlorpyrifos  56            x1
CX1D7R11  chlorpyrifos   7            x1
CX4D56R11 chlorpyrifos  56            x4
CX4D7R11  chlorpyrifos   7            x4
YX1D56R11 cypermethrin  56            x1
YX1D7R11  cypermethrin   7            x1
YX4D56R11 cypermethrin  56            x4
YX4D7R11  cypermethrin   7            x4
> 
> dim(t(log_otus))
[1] 22 39
> 
> # data preparation done
> 
> #################################################################
> # MDS
> 
> mds <- metaMDS(t(log_otus), maxit=10000, trymax=1000)
Wisconsin double standardization
Run 0 stress 0.08622584 
Run 1 stress 0.08591885 
... New best solution
... Procrustes: rmse 0.00817866  max resid 0.02769581 
Run 2 stress 0.1673061 
Run 3 stress 0.1310105 
Run 4 stress 0.0859189 
... Procrustes: rmse 0.0001534027  max resid 0.0005683758 
... Similar to previous best
Run 5 stress 0.1332493 
Run 6 stress 0.08591876 
... New best solution
... Procrustes: rmse 0.0001020132  max resid 0.0004005928 
... Similar to previous best
Run 7 stress 0.1306823 
Run 8 stress 0.08622804 
... Procrustes: rmse 0.008537099  max resid 0.02885239 
Run 9 stress 0.08591886 
... Procrustes: rmse 0.0001122195  max resid 0.0004405201 
... Similar to previous best
Run 10 stress 0.08622761 
... Procrustes: rmse 0.00844103  max resid 0.02854657 
Run 11 stress 0.08622439 
... Procrustes: rmse 0.008004186  max resid 0.02716316 
Run 12 stress 0.08622929 
... Procrustes: rmse 0.008744146  max resid 0.02948118 
Run 13 stress 0.1310098 
Run 14 stress 0.08623017 
... Procrustes: rmse 0.008895849  max resid 0.02994471 
Run 15 stress 0.08591963 
... Procrustes: rmse 0.0003959306  max resid 0.001557789 
... Similar to previous best
Run 16 stress 0.08622969 
... Procrustes: rmse 0.008809518  max resid 0.0296927 
Run 17 stress 0.08622782 
... Procrustes: rmse 0.008500974  max resid 0.02874803 
Run 18 stress 0.1303425 
Run 19 stress 0.08622865 
... Procrustes: rmse 0.008652275  max resid 0.02919674 
Run 20 stress 0.1332493 
*** Solution reached
> mds

Call:
metaMDS(comm = t(log_otus), trymax = 1000, maxit = 10000) 

global Multidimensional Scaling using monoMDS

Data:     wisconsin(t(log_otus)) 
Distance: bray 

Dimensions: 2 
Stress:     0.08591876 
Stress type 1, weak ties
Two convergent solutions found after 20 tries
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on ‘wisconsin(t(log_otus))’ 

> 
> mds$points
                  MDS1          MDS2
ConD0R12  -0.047385216 -0.0536735538
ConD0R21  -0.032542967 -0.0253830499
ConD56R21  0.003182400  0.0176251550
ConD7R21   0.024623108 -0.0211047046
CX1D56R21 -0.025477006  0.0077989547
CX1D7R21   0.048323859 -0.0161334550
CX4D56R21 -0.015242265  0.0012231574
CX4D7R21   0.065298643 -0.0217874089
YX1D56R21 -0.052918123 -0.0053592215
YX1D7R21   0.014722893  0.0012943869
YX4D56R21 -0.035935443 -0.0241707568
YX4D7R21  -0.002766401 -0.0047784912
ConD56R12  0.024304130  0.0334929385
ConD7R11   0.036427435  0.0001736632
CX1D56R11 -0.007608155  0.0298976035
CX1D7R11   0.025991231  0.0074769449
CX4D56R11 -0.020137042  0.0350214512
CX4D7R11   0.039745683  0.0144798917
YX1D56R11 -0.050839091  0.0149392841
YX1D7R11   0.018358637 -0.0061582981
YX4D56R11 -0.039135934  0.0277983006
YX4D7R11   0.029009625 -0.0126727919
attr(,"centre")
[1] TRUE
attr(,"pc")
[1] TRUE
attr(,"halfchange")
[1] TRUE
attr(,"internalscaling")
[1] 24.69778
> x=mds$points[sample_full$pesticide == 'control', 1]
> y=mds$points[sample_full$pesticide == 'control', 2]
> 
> pdf("13.MDS.pdf")#, width=5, height=5)
> 
> plot(mds$points, type = "n")
> points(x, y, cex = 2.0, pch=21, col="black", bg="black")
> points(mds$points[sample_full$pesticide == 'chlorpyrifos' & sample_full$concentration == 'x4', ], cex = 2.0, pch=24, col="black", bg="magenta")
> points(mds$points[sample_full$pesticide == 'chlorpyrifos' & sample_full$concentration == 'x1', ], cex = 2.0, pch=25, col="black", bg="magenta")
> points(mds$points[sample_full$pesticide == 'cypermethrin' & sample_full$concentration == 'x4', ], cex = 2.0, pch=24, col="black", bg="cyan")
> points(mds$points[sample_full$pesticide == 'cypermethrin' & sample_full$concentration == 'x1', ], cex = 2.0, pch=25, col="black", bg="cyan")
> points(mds$points[sample_full$day == 0, ], cex = 1.0, pch=21, col="black", bg="white")
> points(mds$points[sample_full$day == 7, ], cex = 1.0, pch=21, col="black", bg="grey")
> points(mds$points[sample_full$day == 56, ], cex = 1.0, pch=21, col="black", bg="black")
> 
> dev.off()
null device 
          1 
> 
> 
> #################################################################
> # constrainted ordination
> 
> pdf("13.CCA.pdf")
> 
> ord <- cca(t(log_otus) ~ pesticide + concentration + day, data = sample_full)
> ord
Call: cca(formula = t(log_otus) ~ pesticide + concentration + day, data
= sample_full)

               Inertia Proportion Rank
Total         0.006274   1.000000     
Constrained   0.002435   0.388135    4
Unconstrained 0.003839   0.611865   17
Inertia is mean squared contingency coefficient 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
     CCA1      CCA2      CCA3      CCA4 
0.0016059 0.0004595 0.0002847 0.0000852 

Eigenvalues for unconstrained axes:
      CA1       CA2       CA3       CA4       CA5       CA6       CA7       CA8 
0.0015749 0.0008179 0.0004179 0.0002424 0.0001907 0.0001243 0.0001168 0.0000905 
(Showed only 8 of all 17 unconstrained eigenvalues)

> summary(ord)

Call:
cca(formula = t(log_otus) ~ pesticide + concentration + day,      data = sample_full) 

Partitioning of mean squared contingency coefficient:
               Inertia Proportion
Total         0.006274     1.0000
Constrained   0.002435     0.3881
Unconstrained 0.003839     0.6119

Eigenvalues, and their contribution to the mean squared contingency coefficient 

Importance of components:
                          CCA1      CCA2      CCA3      CCA4      CA1       CA2
Eigenvalue            0.001606 0.0004595 0.0002847 8.519e-05 0.001575 0.0008179
Proportion Explained  0.255950 0.0732400 0.0453700 1.358e-02 0.251010 0.1303500
Cumulative Proportion 0.255950 0.3291800 0.3745600 3.881e-01 0.639150 0.7695000
                            CA3       CA4       CA5       CA6       CA7
Eigenvalue            0.0004179 0.0002424 0.0001907 0.0001243 0.0001168
Proportion Explained  0.0666000 0.0386300 0.0303900 0.0198100 0.0186100
Cumulative Proportion 0.8361000 0.8747300 0.9051200 0.9249300 0.9435500
                            CA8       CA9      CA10      CA11      CA12
Eigenvalue            9.048e-05 7.214e-05 5.115e-05 4.461e-05 3.502e-05
Proportion Explained  1.442e-02 1.150e-02 8.150e-03 7.110e-03 5.580e-03
Cumulative Proportion 9.580e-01 9.695e-01 9.776e-01 9.847e-01 9.903e-01
                           CA13      CA14      CA15      CA16      CA17
Eigenvalue            2.753e-05 1.304e-05 9.570e-06 6.103e-06 4.578e-06
Proportion Explained  4.390e-03 2.080e-03 1.530e-03 9.700e-04 7.300e-04
Cumulative Proportion 9.947e-01 9.968e-01 9.983e-01 9.993e-01 1.000e+00

Accumulated constrained eigenvalues
Importance of components:
                          CCA1      CCA2      CCA3      CCA4
Eigenvalue            0.001606 0.0004595 0.0002847 8.519e-05
Proportion Explained  0.659430 0.1886900 0.1169000 3.498e-02
Cumulative Proportion 0.659430 0.8481200 0.9650200 1.000e+00

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions


Species scores

             CCA1       CCA2       CCA3       CCA4        CA1       CA2
Zotu8   -0.039415  0.0098169 -0.0150019 -0.0040523 -0.0424949 -0.001502
Zotu5   -0.030094  0.0124704  0.0116734  0.0199260 -0.0295797 -0.010754
Zotu3   -0.058550 -0.0133592 -0.0151704  0.0044687 -0.0608867  0.003153
Zotu1   -0.037550 -0.0317650  0.0223043 -0.0043492 -0.0132317 -0.024224
Zotu7   -0.013808  0.0070366  0.0006046 -0.0021801 -0.0341182  0.012838
Zotu48   0.040218  0.0093848 -0.0103838  0.0062783  0.0278009  0.011487
Zotu11   0.058465  0.0035716 -0.0120451  0.0063265  0.0143604  0.015088
Zotu89   0.016054 -0.0073328  0.0077362 -0.0069264  0.0193274  0.023453
Zotu55   0.016055  0.0033728  0.0037862  0.0031242  0.0285101 -0.021606
Zotu71  -0.008315  0.0037834  0.0136686 -0.0115543  0.0145756  0.008737
Zotu110  0.026221  0.0250231 -0.0147281 -0.0039928 -0.0024419  0.018867
Zotu311  0.012075  0.0039101 -0.0019547 -0.0006708  0.0155144  0.004609
Zotu59   0.042583 -0.0053435 -0.0021137 -0.0043214  0.0589629  0.021706
Zotu87   0.029561 -0.0040482 -0.0023993  0.0017635  0.0436122 -0.024788
Zotu46   0.061588  0.0204109 -0.0179134  0.0152516 -0.0203554  0.040442
Zotu146  0.000422 -0.0101277 -0.0011924  0.0045302  0.0260840 -0.023653
Zotu60  -0.081676  0.0350094 -0.0285795 -0.0001895 -0.0866406 -0.009679
Zotu142  0.050645  0.0005205  0.0022538 -0.0117718  0.0604186  0.021795
Zotu346 -0.031145 -0.0166619  0.0220442 -0.0085935  0.0108028 -0.015276
Zotu66   0.001750 -0.0096131  0.0310272  0.0267194  0.0097092 -0.018769
Zotu93   0.017938 -0.0014498  0.0020691  0.0005618  0.0408082 -0.025223
Zotu423 -0.036018 -0.0180286  0.0266717 -0.0066734  0.0054326 -0.011225
Zotu222  0.005753 -0.0194142  0.0126086  0.0090139 -0.0006170 -0.002081
Zotu230 -0.028866 -0.0138619  0.0223408 -0.0064057  0.0110911 -0.019117
Zotu53   0.034686  0.0020341 -0.0002463 -0.0023542  0.0337543  0.034514
Zotu225  0.026655 -0.0053982  0.0078747 -0.0057908  0.0636129 -0.004506
Zotu387  0.053016  0.0071458 -0.0088534  0.0055902  0.0272439  0.013549
Zotu109  0.013885 -0.0583683 -0.0272645  0.0047861 -0.0004636  0.037212
Zotu80   0.039417  0.0622127  0.0377110 -0.0199469 -0.0704464 -0.005547
Zotu94  -0.033690 -0.0206597 -0.0220584  0.0022575  0.0036844 -0.015354
Zotu83   0.007278  0.0461231 -0.0093503  0.0004320 -0.0634139  0.041221
Zotu183 -0.089194  0.0018817 -0.0173902 -0.0043239 -0.0915269 -0.013953
Zotu407  0.029641 -0.0123478 -0.0058074 -0.0106631  0.0554963 -0.020228
Zotu169 -0.045985  0.0417482  0.0097637  0.0138326 -0.0409160  0.022439
Zotu445  0.003145 -0.0035810 -0.0103538 -0.0123528 -0.0034392  0.071533
Zotu449  0.028435 -0.0158642  0.0039048  0.0020084  0.0386139 -0.008708
Zotu427  0.004726 -0.0232930  0.0224023  0.0041973  0.0140005 -0.022930
Zotu378  0.026261 -0.0314073 -0.0509266 -0.0166667 -0.0661106 -0.005853
Zotu481 -0.118582  0.0227491 -0.0095618 -0.0044590 -0.0228143 -0.141071


Site scores (weighted averages of species scores)

              CCA1     CCA2     CCA3     CCA4      CA1     CA2
ConD0R12   0.39867 -2.43832  4.10157 -0.71921  2.65021 -0.3266
ConD0R21   1.00224 -1.91750  1.57793 -0.27968  2.02431  0.6376
ConD56R21  0.28783  1.10040  2.55615 -1.74521 -0.98272 -0.6512
ConD7R21  -1.24082 -0.80140  0.58449  1.43607 -0.30911 -0.7600
CX1D56R21  0.72517  0.65973  0.53275  1.52395  0.87318 -0.4073
CX1D7R21  -1.98524  1.11514  0.07613  1.25457 -0.38726 -1.4718
CX4D56R21  0.29318  0.69002  0.22517 -2.04400  0.59719 -0.8806
CX4D7R21  -2.68401  1.65565 -0.89192 -0.91159 -0.99367 -2.3105
YX1D56R21  1.80095 -0.81672 -0.33948  1.43072  0.72497 -0.9055
YX1D7R21  -0.54231 -0.88682  0.20063  0.11874 -0.35159  0.5517
YX4D56R21  1.16876 -2.34827  0.71071 -0.49889  0.93722 -1.2560
YX4D7R21  -0.16198 -1.14127 -0.22729 -1.88539  0.25665  0.3191
ConD56R12  0.07472  1.82788  1.33099  0.30757 -1.92812  0.3877
ConD7R11  -1.27980  0.06137 -0.33178  0.08552 -1.05554  0.6772
CX1D56R11  0.72348  1.75743 -0.69558  1.71545 -0.04606  0.7486
CX1D7R11  -1.08443  1.02276 -0.30713  0.63967 -0.12188  0.7443
CX4D56R11  0.95716  1.40710 -0.87544 -2.80846  0.47374  1.4013
CX4D7R11  -1.02121  0.69432 -1.62016  0.43401 -0.37245  1.9324
YX1D56R11  2.05930  0.11597 -1.36746  1.32558  0.10213  0.3304
YX1D7R11  -0.30156 -1.12965 -1.63900  1.61832 -0.76753  0.2853
YX4D56R11  1.86015  0.08727 -1.56740 -0.94755  0.02843  1.1160
YX4D7R11  -0.96367 -1.24918 -1.51795 -0.15036 -0.87070 -0.5765


Site constraints (linear combinations of constraining variables)

             CCA1    CCA2    CCA3     CCA4      CA1     CA2
ConD0R12  -0.9057 -0.6950  1.4777 -0.01567  2.65021 -0.3266
ConD0R21  -0.9057 -0.6950  1.4777 -0.01567  2.02431  0.6376
ConD56R21  1.0664  0.3195  1.8040 -0.37907 -0.98272 -0.6512
ConD7R21  -0.6592 -0.5682  1.5185 -0.06109 -0.30911 -0.7600
CX1D56R21  0.4809  1.6932 -0.1684  0.97726  0.87318 -0.4073
CX1D7R21  -1.2447  0.8055 -0.4539  1.29523 -0.38726 -1.4718
CX4D56R21  0.2431  1.4505 -0.4591 -1.31987  0.59719 -0.8806
CX4D7R21  -1.4826  0.5628 -0.7446 -1.00190 -0.99367 -2.3105
YX1D56R21  1.5995 -0.3403 -0.4398  1.10587  0.72497 -0.9055
YX1D7R21  -0.1261 -1.2280 -0.7253  1.42385 -0.35159  0.5517
YX4D56R21  1.3617 -0.5830 -0.7306 -1.19126  0.93722 -1.2560
YX4D7R21  -0.3640 -1.4707 -1.0161 -0.87328  0.25665  0.3191
ConD56R12  1.0664  0.3195  1.8040 -0.37907 -1.92812  0.3877
ConD7R11  -0.6592 -0.5682  1.5185 -0.06109 -1.05554  0.6772
CX1D56R11  0.4809  1.6932 -0.1684  0.97726 -0.04606  0.7486
CX1D7R11  -1.2447  0.8055 -0.4539  1.29523 -0.12188  0.7443
CX4D56R11  0.2431  1.4505 -0.4591 -1.31987  0.47374  1.4013
CX4D7R11  -1.4826  0.5628 -0.7446 -1.00190 -0.37245  1.9324
YX1D56R11  1.5995 -0.3403 -0.4398  1.10587  0.10213  0.3304
YX1D7R11  -0.1261 -1.2280 -0.7253  1.42385 -0.76753  0.2853
YX4D56R11  1.3617 -0.5830 -0.7306 -1.19126  0.02843  1.1160
YX4D7R11  -0.3640 -1.4707 -1.0161 -0.87328 -0.87070 -0.5765


Biplot scores for constraining variables

                          CCA1    CCA2     CCA3     CCA4 CA1 CA2
pesticidecontrol      -0.08481 -0.1828  0.97484 -0.09529   0   0
pesticidecypermethrin  0.46251 -0.6879 -0.55134  0.09457   0   0
concentrationx1        0.13374  0.1768 -0.34021  0.91385   0   0
day                    0.87002  0.4730 -0.02314 -0.13713   0   0


Centroids for factor constraints

                          CCA1    CCA2    CCA3      CCA4 CA1 CA2
pesticidechlorpyrifos -0.50522  1.1259 -0.4569 -0.008808   0   0
pesticidecontrol      -0.13959 -0.3009  1.6045 -0.156841   0   0
pesticidecypermethrin  0.61095 -0.9086 -0.7283  0.124923   0   0
concentrationx1        0.17573  0.2323 -0.4470  1.200788   0   0
concentrationx4       -0.07375 -0.0112 -0.7388 -1.094866   0   0

> anova(ord)
Permutation test for cca under reduced model
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + day, data = sample_full)
         Df ChiSquare     F Pr(>F)   
Model     4 0.0024353 2.696  0.002 **
Residual 17 0.0038391                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord, by="term")
Permutation test for cca under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + day, data = sample_full)
              Df ChiSquare      F Pr(>F)   
pesticide      2 0.0010149 2.2472  0.026 * 
concentration  1 0.0001095 0.4847  0.858   
day            1 0.0013109 5.8048  0.003 **
Residual      17 0.0038391                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord, by="mar")
Permutation test for cca under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + day, data = sample_full)
              Df ChiSquare      F Pr(>F)   
pesticide      1 0.0007180 3.1792  0.017 * 
concentration  1 0.0001080 0.4783  0.841   
day            1 0.0013109 5.8048  0.002 **
Residual      17 0.0038391                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord, by="axis")
Permutation test for cca under reduced model
Marginal tests for axes
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + day, data = sample_full)
         Df ChiSquare      F Pr(>F)   
CCA1      1 0.0016059 7.1112  0.002 **
CCA2      1 0.0004595 2.0348  0.078 . 
CCA3      1 0.0002847 1.2606  0.244   
CCA4      1 0.0000852 0.3772  0.938   
Residual 17 0.0038391                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> plot(ord)
> 
> ord_c_d <- cca(t(log_otus) ~ pesticide + concentration + Condition(day), data = sample_full)
> anova(ord_c_d)
Permutation test for cca under reduced model
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + Condition(day), data = sample_full)
         Df ChiSquare      F Pr(>F)  
Model     3 0.0011152 1.6461  0.068 .
Residual 17 0.0038391                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord_c_d, by="term")
Permutation test for cca under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + Condition(day), data = sample_full)
              Df ChiSquare      F Pr(>F)  
pesticide      2 0.0010072 2.2300  0.033 *
concentration  1 0.0001080 0.4783  0.859  
Residual      17 0.0038391                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord_c_d, by="mar")
Permutation test for cca under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + Condition(day), data = sample_full)
              Df ChiSquare      F Pr(>F)  
pesticide      1 0.0007180 3.1792  0.013 *
concentration  1 0.0001080 0.4783  0.850  
Residual      17 0.0038391                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord_c_d, by="axis")
Permutation test for cca under reduced model
Marginal tests for axes
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + concentration + Condition(day), data = sample_full)
         Df ChiSquare      F Pr(>F)  
CCA1      1 0.0007284 3.2254  0.035 *
CCA2      1 0.0002850 1.2620  0.374  
CCA3      1 0.0001018 0.4508  0.934  
Residual 17 0.0038391                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> ord_c_c <- cca(t(log_otus) ~ pesticide + Condition(concentration) + day, data = sample_full)
> anova(ord_c_c)
Permutation test for cca under reduced model
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + Condition(concentration) + day, data = sample_full)
         Df ChiSquare     F Pr(>F)    
Model     2 0.0020274 4.489  0.001 ***
Residual 17 0.0038391                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord_c_c, by="term")
Permutation test for cca under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + Condition(concentration) + day, data = sample_full)
          Df ChiSquare      F Pr(>F)    
pesticide  1 0.0007166 3.1731  0.008 ** 
day        1 0.0013109 5.8048  0.001 ***
Residual  17 0.0038391                  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> anova(ord_c_c, by="mar")
Permutation test for cca under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 999

Model: cca(formula = t(log_otus) ~ pesticide + Condition(concentration) + day, data = sample_full)
          Df ChiSquare      F Pr(>F)   
pesticide  1 0.0007180 3.1792  0.018 * 
day        1 0.0013109 5.8048  0.002 **
Residual  17 0.0038391                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> dev.off()
null device 
          1 
> 
> ################################################################
> # rarefaction
> 
> pdf("13.rarefaction.pdf")
> 
> raw_otus_t <- t(raw_otus)
> S <- specnumber(raw_otus_t)
> (raremax <- min(rowSums(raw_otus_t)))
[1] 40237
> Srare <- rarefy(raw_otus_t, raremax)
> plot(S, Srare, xlab = "Observed No. of Species", ylab = "Rarefied No. of Species")
> abline(0, 1)
> rarecurve(raw_otus_t, step = 20, sample = raremax, col = "blue", cex = 0.6)
> 
> dev.off()
null device 
          1 
> 
> ################################################################
> # diversity
> 
> pdf("13.diversity.pdf")
> 
> H <- diversity(raw_otus_t, "shannon")
> write.table(H, '13.shannon.xls', col.names = NA, row.names = TRUE, sep='\t')
> simp <- diversity(raw_otus_t, "simpson")
> write.table(simp, '13.simpson.xls', col.names = NA, row.names = TRUE, sep='\t')
> invsimp <- diversity(raw_otus_t, "inv")
> write.table(invsimp, '13.invsimpson.xls', col.names = NA, row.names = TRUE, sep='\t')
> invsimp
 ConD0R12  ConD0R21 ConD56R21  ConD7R21 CX1D56R21  CX1D7R21 CX4D56R21  CX4D7R21 
226.73659 230.28903 112.49373  88.32675 102.16056  80.84431 155.53070  48.88561 
YX1D56R21  YX1D7R21 YX4D56R21  YX4D7R21 ConD56R12  ConD7R11 CX1D56R11  CX1D7R11 
168.68743  73.52632 225.52424  83.15212  67.46330  43.24858  61.37598  55.72599 
CX4D56R11  CX4D7R11 YX1D56R11  YX1D7R11 YX4D56R11  YX4D7R11 
114.68327  39.12093 110.07824  64.33751  41.07641  74.28854 
> ## Unbiased Simpson (Hurlbert 1971, eq. 5) with rarefy:
> unbias.simp <- rarefy(raw_otus_t, 2) - 1
> ## Fisher alpha
> alpha <- fisher.alpha(raw_otus_t)
> alpha
 ConD0R12  ConD0R21 ConD56R21  ConD7R21 CX1D56R21  CX1D7R21 CX4D56R21  CX4D7R21 
 497.6557  468.3574  448.7460  456.9275  442.2008  453.7502  461.3315  420.5408 
YX1D56R21  YX1D7R21 YX4D56R21  YX4D7R21 ConD56R12  ConD7R11 CX1D56R11  CX1D7R11 
 446.2344  432.8006  477.0779  426.7704  422.8231  413.0425  375.5862  427.1365 
CX4D56R11  CX4D7R11 YX1D56R11  YX1D7R11 YX4D56R11  YX4D7R11 
 430.9699  403.8022  411.0463  430.6375  388.5293  434.4502 
> ## Plot all
> pairs(cbind(H, simp, invsimp, unbias.simp, alpha), pch="+", col="blue")
> ## Species richness (S) and Pielou's evenness (J):
> S <- specnumber(raw_otus_t) ## rowSums(raw_otus_t > 0) does the same...
> J <- H/log(S)
> 
> barplot(H)
> barplot(simp)
> barplot(invsimp)
> barplot(alpha)
> 
> 
> ## Raw data and plotting
> m <- betadiver(raw_otus_t)
> plot(m)
> ## The indices
> betadiver(help=TRUE)
1 "w" = (b+c)/(2*a+b+c)
2 "-1" = (b+c)/(2*a+b+c)
3 "c" = (b+c)/2
4 "wb" = b+c
5 "r" = 2*b*c/((a+b+c)^2-2*b*c)
6 "I" = log(2*a+b+c) - 2*a*log(2)/(2*a+b+c) - ((a+b)*log(a+b) +
(a+c)*log(a+c)) / (2*a+b+c)
7 "e" = exp(log(2*a+b+c) - 2*a*log(2)/(2*a+b+c) - ((a+b)*log(a+b) +
(a+c)*log(a+c)) / (2*a+b+c))-1
8 "t" = (b+c)/(2*a+b+c)
9 "me" = (b+c)/(2*a+b+c)
10 "j" = a/(a+b+c)
11 "sor" = 2*a/(2*a+b+c)
12 "m" = (2*a+b+c)*(b+c)/(a+b+c)
13 "-2" = pmin(b,c)/(pmax(b,c)+a)
14 "co" = (a*c+a*b+2*b*c)/(2*(a+b)*(a+c))
15 "cc" = (b+c)/(a+b+c)
16 "g" = (b+c)/(a+b+c)
17 "-3" = pmin(b,c)/(a+b+c)
18 "l" = (b+c)/2
19 "19" = 2*(b*c+1)/(a+b+c)/(a+b+c-1)
20 "hk" = (b+c)/(2*a+b+c)
21 "rlb" = a/(a+c)
22 "sim" = pmin(b,c)/(pmin(b,c)+a)
23 "gl" = 2*abs(b-c)/(2*a+b+c)
24 "z" = (log(2)-log(2*a+b+c)+log(a+b+c))/log(2)
> ## The basic Whittaker index
> d <- betadiver(raw_otus_t, "w")
> 
> heatmap(as.matrix(d))
> write.table(as.matrix(d), '13.whittaker.xls', col.names = NA, row.names= T, sep='\t')
> 
> ## This should be equal to Sorensen index (binary Bray-Curtis in
> ## vegan)
> range(d - vegdist(raw_otus_t, binary=TRUE))
[1] 0 0
> 
> 
> dev.off()
null device 
          1 
> 
